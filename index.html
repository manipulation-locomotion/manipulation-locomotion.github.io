<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description" content="Deep Whole-Body Control: Learning a Unified Policy for Manipulation and Locomotion">
  <meta name="keywords" content="Mobile Manipulation, Legged Locomotion, Whole-Body Control, Reinforcement Learning">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Deep Whole-Body Control: Learning a Unified Policy for Manipulation and Locomotion</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" /> -->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

  <link rel="icon" href="./favicon.ico">

  <meta property="og:site_name" content="Deep Whole-Body Control: Learning a Unified Policy for Manipulation and Locomotion" />
  <meta property="og:type" content="video.other" />
  <meta property="og:title" content="Deep Whole-Body Control: Learning a Unified Policy for Manipulation and Locomotion" />
  <meta property="og:description" content="by Zipeng Fu, Xuxin Cheng, Deepak Pathak" />
  <meta property="og:url" content="https://manipulation-locomotion.github.io/" />
  <meta property="og:image" content="https://manipulation-locomotion.github.io/static/images/preview.gif" />
  <meta property="og:image:secure" content="https://manipulation-locomotion.github.io/static/images/preview.gif" />
  <meta property="og:video" content="https://www.youtube.com/embed/4-2j3L86ZL4" />
  <meta property="og:video:secure" content="https://www.youtube.com/embed/4-2j3L86ZL4" />
  <meta property="og:image:width" content="1280" />
  <meta property="og:image:height" content="720" />

  <meta property="article:publisher" content="https://zipengfu.github.io" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Deep Whole-Body Control: Learning a Unified Policy for Manipulation and Locomotion" />
  <meta name="twitter:description" content="by Zipeng Fu, Xuxin Cheng, Deepak Pathak" />
  <meta name="twitter:url" content="https://manipulation-locomotion.github.io/" />
  <meta name="twitter:image" content="https://manipulation-locomotion.github.io/static/images/preview.gif" />
  <meta name="twitter:site" content="@zipengfu" />
  <meta name="twitter:card" content="player" />
  <meta name="twitter:player" content="https://www.youtube.com/embed/4-2j3L86ZL4" />
  <meta name="twitter:player:width" content="1280" />
  <meta name="twitter:player:height" content="720" />

  <script src="https://www.youtube.com/iframe_api"></script>
</head>


<body>

<section class="hero">
  <div class="hero-body">
    <div class="container">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Deep Whole-Body Control: Learning a Unified Policy for Manipulation and Locomotion</h1>
          <div class="is-size-4 publication-authors">
            <span class="author-block">
              <a href="https://zipengfu.github.io/">Zipeng Fu</a><sup>*</sup>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
              <a href="https://chengxuxin.github.io/">Xuxin Cheng</a><sup>*</sup>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
              <a href="https://www.cs.cmu.edu/~dpathak/">Deepak Pathak</a>
              <br>Carnegie Mellon University
              <span class="brmod">CoRL 2022 (Oral)</span>
            </span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="./resources/Deep-Whole-Body-Control.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <!-- arXiv Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2210.10044"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- OpenReview Link. -->
              <span class="link-block">
                <a href="https://openreview.net/forum?id=zldI4UpuG7v"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <!-- <i class="fas fa-external-link-alt"></i> -->
                      <img src="static/images/openreview.ico"></img>
                  </span>
                  <span>OpenReview</span>
                </a>
              </span>
              <!-- Video Link. -->
              <span class="link-block">
                <a href="#method_video"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>
              <!-- Bilibili Link. -->
              <span class="link-block">
                <a href="https://www.bilibili.com/video/BV1mY411Z7ag/"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <svg style="color: white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M488.6 104.1C505.3 122.2 513 143.8 511.9 169.8V372.2C511.5 398.6 502.7 420.3 485.4 437.3C468.2 454.3 446.3 463.2 419.9 464H92.02C65.57 463.2 43.81 454.2 26.74 436.8C9.682 419.4 .7667 396.5 0 368.2V169.8C.7667 143.8 9.682 122.2 26.74 104.1C43.81 87.75 65.57 78.77 92.02 78H121.4L96.05 52.19C90.3 46.46 87.42 39.19 87.42 30.4C87.42 21.6 90.3 14.34 96.05 8.603C101.8 2.868 109.1 0 117.9 0C126.7 0 134 2.868 139.8 8.603L213.1 78H301.1L375.6 8.603C381.7 2.868 389.2 0 398 0C406.8 0 414.1 2.868 419.9 8.603C425.6 14.34 428.5 21.6 428.5 30.4C428.5 39.19 425.6 46.46 419.9 52.19L394.6 78L423.9 78C450.3 78.77 471.9 87.75 488.6 104.1H488.6zM449.8 173.8C449.4 164.2 446.1 156.4 439.1 150.3C433.9 144.2 425.1 140.9 416.4 140.5H96.05C86.46 140.9 78.6 144.2 72.47 150.3C66.33 156.4 63.07 164.2 62.69 173.8V368.2C62.69 377.4 65.95 385.2 72.47 391.7C78.99 398.2 86.85 401.5 96.05 401.5H416.4C425.6 401.5 433.4 398.2 439.7 391.7C446 385.2 449.4 377.4 449.8 368.2L449.8 173.8zM185.5 216.5C191.8 222.8 195.2 230.6 195.6 239.7V273C195.2 282.2 191.9 289.9 185.8 296.2C179.6 302.5 171.8 305.7 162.2 305.7C152.6 305.7 144.7 302.5 138.6 296.2C132.5 289.9 129.2 282.2 128.8 273V239.7C129.2 230.6 132.6 222.8 138.9 216.5C145.2 210.2 152.1 206.9 162.2 206.5C171.4 206.9 179.2 210.2 185.5 216.5H185.5zM377 216.5C383.3 222.8 386.7 230.6 387.1 239.7V273C386.7 282.2 383.4 289.9 377.3 296.2C371.2 302.5 363.3 305.7 353.7 305.7C344.1 305.7 336.3 302.5 330.1 296.2C323.1 289.9 320.7 282.2 320.4 273V239.7C320.7 230.6 324.1 222.8 330.4 216.5C336.7 210.2 344.5 206.9 353.7 206.5C362.9 206.9 370.7 210.2 377 216.5H377z" fill="white"></path></svg>                    </span>
                    <span>Bilibili</span>
                </a>
              </span>
              <!-- twitter Link. -->
              <span class="link-block">
                <a href="https://twitter.com/pathak2206/status/1582813387716583425?s=61&t=fGk6XPnGsm22-fCcbdM2wQ"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-twitter"></i>
                  </span>
                  <span>Summary</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/MarkFzp/Deep-Whole-Body-Control" class="external-link button is-normal is-rounded">
                  <span class="icon">
                      <svg class="svg-inline--fa fa-github fa-w-16" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><!-- <i class="fab fa-github"></i> Font Awesome fontawesome.com -->
                  </span>
                  <span>Code (soon)</span>
                </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <div class="columns is-centered">
      <tr>
        <td>
      <div class="column is-full-width is-centered has-text-centered">
          <video controls autoplay muted loop playsinline poster="./resources/loading-icon.gif" style="width: 47.5%; border: 1px solid #bbb; border-radius: 10px; margin: 1.0%;">
            <source src="./resources/teaser/teaser-wbc.mp4" type="video/mp4">
          </video>
          <video controls autoplay muted loop playsinline poster="./resources/loading-icon.gif" style="width: 47.5%; border: 1px solid #bbb; border-radius: 10px; margin: 1.0%;">
            <source src="./resources/teaser/teaser-pick.mp4" type="video/mp4">
          </video>
          <h2 class="subtitle has-text-centered">
            <strong>Whole-body control via a unified learned policy achieves agile and dynamic behaviors on our custom-built low-cost legged manipulator</strong>
          </h2>
      </div>
    </td>
  </tr>
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-two-thirds">
        <h2 class="title is-2">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            An attached arm can significantly increase the applicability of legged robots to several mobile manipulation tasks that are not possible for the wheeled or tracked counterparts. The standard control pipeline for such legged manipulators is to decouple the controller into that of manipulation and locomotion. However, this is ineffective and requires immense engineering to support coordination between the arm and legs, error can propagate across modules causing non-smooth unnatural motions. It is also biological implausible where there is evidence for strong motor synergies across limbs. In this work, we propose to learn a unified policy for whole-body control of a legged manipulator using reinforcement learning. We propose Regularized Online Adaptation to bridge the Sim2Real gap for high-DoF control, and Advantage Mixing exploiting the causal dependency in the action space to overcome local minima during training the whole-body system. We also present a simple design for a low-cost legged manipulator, and find that our unified policy can demonstrate dynamic and agile behaviors across several task setups.           </p>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-full-width">
        <!-- Paper video. -->
        <h2 class="title is-2" style="text-align: center;" id="method_video" >Project Video</h2>
        <br>
        <div class="columns is-centered has-text-centered">
            <div class="publication-video">
              <iframe src="https://www.youtube.com/embed/t6NoCx_zitM" title="Deep Whole-Body Control: Learning a Unified Policy for Manipulation and Locomotion (CoRL 2022)"
                      frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
            </div>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container">
    <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-2" style="text-align: center;">Teleoperation</h2>
          <div class="columns is-centered has-text-centered">
            <div class="column is-two-thirds">
              <div class="content has-text-justified">
                <p>
                  Given only the gripper end-effector command and the command velocity of the quadruped, our trained unified policy controls all the joints of the legs and arm in 50 Hz without any finetuning in the real world.
                </p>
              </div>
            </div>
          </div>
          <tr>
            <td>
              <br>
                <div class="columns is-centered has-text-centered v-divider">
                  <video controls autoplay loop muted playsinline src="./resources/tele/place.mp4" poster="./resources/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; width: 50%;"></video>
                  &nbsp;
                  <video controls autoplay loop muted playsinline src="./resources/tele/garbage.mp4" poster="./resources/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; width: 50%;"></video>
                </div>
                <br>              
                <div class="columns is-centered has-text-centered v-divider">
                  <video controls autoplay loop muted playsinline src="./resources/tele/bush.mp4" poster="./resources/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; width: 50%;"></video>
                  &nbsp;
                  <video controls autoplay loop muted playsinline src="./resources/tele/door.mp4" poster="./resources/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; width: 50%;"></video>
                </div>
            </td>
          </tr>
        </div> 
    </div>
</section>

<section class="section">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-2" style="text-align: center;">Visual Tracking</h2>
        <div class="columns is-centered has-text-centered">
          <div class="column is-two-thirds">
            <div class="content has-text-justified">
            <p>
              The robot is tasked to track the AR tag, and the unified policy automatically adjusts the whole-body control to track the AR tag. For example, bending legs in coordination with the arm to keep the camera near the AR tag.
            </p>
            </div>
          </div>
        </div>
        <tr>
            <td>
              <br>
              <div class="columns is-centered has-text-centered">
                <video controls autoplay loop muted playsinline src="./resources/visual-tracking/human-tracking.mp4" poster="./resources/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; width: 50%;"></video>
                &nbsp;
                <video controls autoplay loop muted playsinline src="./resources/visual-tracking/tag-tracking.mp4" poster="./resources/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; width: 50%;"></video>
              </div>
            </td>
          </tr>
        <tr>
          <td>
            <br>
            <div class="columns is-centered has-text-centered">
                <video controls autoplay loop muted playsinline src="./resources/visual-tracking/vis-easy.mp4" poster="./resources/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; width: 50%;"></video>
                &nbsp;
                <video controls autoplay loop muted playsinline src="./resources/visual-tracking/vis-hard.mp4" poster="./resources/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; width: 50%;"></video>
            </div>
          </td>
        </tr>
      </div> 
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
      <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-2" style="text-align: center;">Demonstration Replay</h2>
          <div class="columns is-centered has-text-centered">
            <div class="column is-two-thirds">
              <div class="content has-text-centered">
              <p>
                Here we show the agility of our robot controlled by the unified policy using demonstrations to perform tasks.
              </p>
              </div>
            </div>
          </div>

          <tr>
              <td>
                <br>
                <div class="columns is-centered has-text-centered">
                  <video controls autoplay loop muted playsinline src="./resources/demo/demo.mp4" poster="./resources/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; width: 50%;"></video>
                  &nbsp;
                  <video controls autoplay loop muted playsinline src="./resources/demo/wiping.mp4" poster="./resources/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; width: 50%;"></video>
                </div>
              </td>
            </tr>
        </div> 
      </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <!-- Abstract. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-2" style="text-align: center;" id="press_coverage">Press Coverage</h2>
        <br>
        <tr>
          <td>
            <div class="row">
              <div class="columns is-centered">
                <div class="col" style="padding: 20px">
                  <a target="_blank" href="https://www.newscientist.com/video/2344985-ai-trains-cheap-robot-dog-to-coordinate-multiple-limbs/">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/c/c0/New_Scientist_logo.svg" width="500px"></img>
                  </a>
                </div>
                <div class="col" style="padding: 20px">
                  <a target="_blank" href="https://www.popsci.com/technology/robot-dog-ai-training/">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/5/5a/Popular_Science.svg" width="500px"></img>
                  </a>
                </div>
                <div class="col" style="padding: 20px">
                  <a target="_blank" href="https://www.raspberrypi.com/news/this-robots-extra-arm-gives-it-whole-body-control/">
                    <img src="https://www.vectorlogo.zone/logos/raspberrypi/raspberrypi-ar21.png" width="500px"></img>
                  </a>
                </div>
                <div class="col" style="padding: 20px">
                  <a target="_blank" href="https://www.generationrobots.com/blog/en/unitree-robotics-carnegie-mellon-university-researchers-teach-a-robot-dog-limb-coordination/">
                    <img src="https://www.generationrobots.com/blog/wp-content/themes/twentytwelve-child/img/logo-blog-2019.jpg" width="500px"></img>
                  </a>
                </div>
              </div>
            </td>
          </tr>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container content">
    <h2 class="titile">BibTeX</h2>
    <pre><code>@inproceedings{fu2022deep,
  author    = {Fu, Zipeng and Cheng, Xuxin and Pathak, Deepak},
  title     = {Deep Whole-Body Control: Learning a Unified Policy for Manipulation and Locomotion},
  booktitle = {Conference on Robot Learning ({CoRL})},
  year      = {2022},
}</code></pre>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <p>Page template borrowed from <a href="https://energy-locomotion.github.io/"><span class="dnerf">Energy-Locomotion</span></a> and <a href="https://nerfies.github.io/"><span class="dnerf">Nerfies</span></a>.</p>
    </div>
  </div>
</footer>

</body>
</html>